"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[57510],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),u=o,h=p["".concat(s,".").concat(u)]||p[u]||m[u]||i;return n?a.createElement(h,r(r({ref:t},d),{},{components:n})):a.createElement(h,r({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,r[1]=l;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},73199:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const i={description:"TUTORIALS - To Do List App"},r="Add Item Buttons",l={unversionedId:"tutorials/todo-list-app/add-item-buttons",id:"tutorials/todo-list-app/add-item-buttons",title:"Add Item Buttons",description:"TUTORIALS - To Do List App",source:"@site/docs/tutorials/todo-list-app/add-item-buttons.md",sourceDirName:"tutorials/todo-list-app",slug:"/tutorials/todo-list-app/add-item-buttons",permalink:"/avalonia-docs/docs/next/tutorials/todo-list-app/add-item-buttons",draft:!1,editUrl:"https://github.com/AvaloniaUI/avalonia-docs/tree/main/docs/tutorials/todo-list-app/add-item-buttons.md",tags:[],version:"current",frontMatter:{description:"TUTORIALS - To Do List App"},sidebar:"documentationSidebar",previous:{title:"The View Locator",permalink:"/avalonia-docs/docs/next/tutorials/todo-list-app/locating-views"},next:{title:"Process a New Item",permalink:"/avalonia-docs/docs/next/tutorials/todo-list-app/process-a-new-item"}},s={},c=[{value:"Bind the OK and Cancel Buttons",id:"bind-the-ok-and-cancel-buttons",level:2}],d={toc:c},p="wrapper";function m(e){let{components:t,...n}=e;return(0,o.kt)(p,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"add-item-buttons"},"Add Item Buttons"),(0,o.kt)("p",null,"On this page, you will learn how to complete the to do list app by adding actions for the buttons in the add item view. You will include some revealed functionality that disables the OK button until the user enters text in the input."," "),(0,o.kt)("p",null,"Also the OK button action needs to pass the description text back to the main window view model, so it can be added to the items collection.  You will do this by passing an argument to the command."),(0,o.kt)("p",null,"To alter the add item view model, follow this procedure:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Stop the app if it is running."),(0,o.kt)("li",{parentName:"ul"},"Locate the ",(0,o.kt)("strong",{parentName:"li"},"AddItemViewModel.cs")," file in the ",(0,o.kt)("strong",{parentName:"li"},"/ViewModels")," folder."),(0,o.kt)("li",{parentName:"ul"},"Edit the code as shown."," ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"using ReactiveUI;\nusing System.Reactive;\nusing ToDoList.DataModel;\n\nnamespace ToDoList.ViewModels\n{\n    public class AddItemViewModel : ViewModelBase\n    {\n        private string _description = string.Empty;\n\n        public ReactiveCommand<Unit, ToDoItem> OkCommand { get; }\n        public ReactiveCommand<Unit, Unit> CancelCommand { get; }\n        \n        public AddItemViewModel()\n        {\n            var isValidObservable = this.WhenAnyValue(\n                x => x.Description,\n                x => !string.IsNullOrWhiteSpace(x));\n\n            OkCommand = ReactiveCommand.Create(\n                () => new ToDoItem { Description = Description }, isValidObservable);\n            CancelCommand = ReactiveCommand.Create(() => { });\n        }\n\n        public string Description\n        {\n            get => _description;\n            set => this.RaiseAndSetIfChanged(ref _description, value);\n        }\n    }\n}\n")),(0,o.kt)("p",null,"Earlier in this tutorial, you bound the add item button directly to the main window view model ",(0,o.kt)("inlineCode",{parentName:"p"},"AddItem")," method. In contrast, the OK button here requires some revealed functionality, and an argument."),(0,o.kt)("p",null,"Therefore this view model code declares a reactive command for the OK button, with its second type parameter ",(0,o.kt)("inlineCode",{parentName:"p"},"ToDoItem")," (from the data model)."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The reactive command is part of ",(0,o.kt)("em",{parentName:"p"},"ReactiveUI"),". For an introduction to this concept, see ",(0,o.kt)("a",{parentName:"p",href:"/avalonia-docs/docs/next/concepts/reactiveui/reactive-command"},"here"),".")),(0,o.kt)("p",null,"Although there is nothing special about the cancel button, a reactive command is declared for that as well. You will see later how this will allow the output from both commands to be handled in the same place. "," "),(0,o.kt)("p",null,"Both reactive command objects are then created in the constructor. The OK command defines a function that passes a to do item parameter. The cancel command has an empty object parameter."," "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"var isValidObservable = this.WhenAnyValue(\n    x => x.Description,\n    x => !string.IsNullOrWhiteSpace(x));\n")),(0,o.kt)("p",null,"To implement the revealed functionality, the code creates an observable based on the description property. The ",(0,o.kt)("inlineCode",{parentName:"p"},"WhenAnyValue")," method returns the result of the second lambda function (second parameter) every time the value of the description property changes."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"private string _description = string.Empty;\npublic string Description\n{\n    get => _description;\n    set => this.RaiseAndSetIfChanged(ref _description, value);\n}\n")),(0,o.kt)("p",null,"To ensure that the observable operates correctly, the code also adds the ",(0,o.kt)("inlineCode",{parentName:"p"},"RaiseAndSetIfChanged")," pattern to the description property."),(0,o.kt)("p",null,"Examine how the OK reactive command is created:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"OkCommand = ReactiveCommand.Create(\n   () => new ToDoItem { Description = Description }, isValidObservable);\n")),(0,o.kt)("p",null,"The first parameter is a lambda function that is run whenever the command is executed. The function here creates an instance of the data model ",(0,o.kt)("inlineCode",{parentName:"p"},"TodoItem")," including the current value of the description."),(0,o.kt)("p",null,"The second lambda function ('can execute' parameter) determines the enabled state of the reactive command. So this is passed the observable created just before."),(0,o.kt)("p",null,"The code also creates a reactive command for the cancel button:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"CancelCommand = ReactiveCommand.Create(() => { });\n")),(0,o.kt)("p",null,"The cancel command has no execution, so its first and only parameter does nothing. The cancel button is always enabled, so it does not have a 'can execute' parameter."," "),(0,o.kt)("h2",{id:"bind-the-ok-and-cancel-buttons"},"Bind the OK and Cancel Buttons"),(0,o.kt)("p",null,"Your next step is to create binding for the OK and cancel buttons in the view."," "),(0,o.kt)("p",null,"To do this, follow this procedure:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Locate the ",(0,o.kt)("strong",{parentName:"li"},"AddItemView.axaml")," file in the ",(0,o.kt)("strong",{parentName:"li"},"/Views")," folder."),(0,o.kt)("li",{parentName:"ul"},"Edit the XAML as shown."," ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-markup"},'<UserControl xmlns="https://github.com/avaloniaui"\n             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n             xmlns:vm="using:ToDoList.ViewModels"\n             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"\n             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"\n             mc:Ignorable="d" d:DesignWidth="250" d:DesignHeight="450"\n             x:Class="ToDoList.Views.AddItemView"\n             x:DataType="vm:AddItemViewModel">\n  <DockPanel>\n    <Button DockPanel.Dock="Bottom" \n            HorizontalAlignment="Stretch"\n            HorizontalContentAlignment="Center"\n            Command="{Binding CancelCommand}">Cancel</Button>\n    <Button DockPanel.Dock="Bottom" \n            HorizontalAlignment="Stretch"\n            HorizontalContentAlignment="Center"\n            Command="{Binding OkCommand}">OK</Button>\n    <TextBox AcceptsReturn="True"\n             Text="{Binding Description}"\n             Watermark="Enter your to do item"/>\n  </DockPanel>\n</UserControl>\n')),(0,o.kt)("p",null,"Run the application and click ",(0,o.kt)("strong",{parentName:"p"},"Add Item"),". You should now see that the OK button is only enabled when there is some text in the description input."),(0,o.kt)("div",{style:{textAlign:"center"}},(0,o.kt)("img",{src:"/img/gitbook-import/assets/image (21) (2).png",alt:""})),(0,o.kt)("div",{style:{textAlign:"center"}},(0,o.kt)("img",{src:"/img/gitbook-import/assets/image (41).png",alt:""})),(0,o.kt)("p",null,"On the next page you will learn how to process the new to do item, so that it appears on the list, if the user clicks OK."," "))}m.isMDXComponent=!0}}]);