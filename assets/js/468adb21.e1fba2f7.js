"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[63352],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=o,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?a.createElement(h,r(r({ref:t},c),{},{components:n})):a.createElement(h,r({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:o,r[1]=l;for(var u=2;u<i;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},23282:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var a=n(87462),o=(n(67294),n(3905));const i={description:"TUTORIALS - Music Store App"},r="Dialog Return",l={unversionedId:"tutorials/music-store-app/return-from-dialog",id:"tutorials/music-store-app/return-from-dialog",title:"Dialog Return",description:"TUTORIALS - Music Store App",source:"@site/docs/tutorials/music-store-app/return-from-dialog.md",sourceDirName:"tutorials/music-store-app",slug:"/tutorials/music-store-app/return-from-dialog",permalink:"/avalonia-docs/docs/next/tutorials/music-store-app/return-from-dialog",draft:!1,editUrl:"https://github.com/AvaloniaUI/avalonia-docs/tree/main/docs/tutorials/music-store-app/return-from-dialog.md",tags:[],version:"current",frontMatter:{description:"TUTORIALS - Music Store App"},sidebar:"documentationSidebar",previous:{title:"Displaying Images",permalink:"/avalonia-docs/docs/next/tutorials/music-store-app/displaying-images"},next:{title:"Add Items to the User's Collection",permalink:"/avalonia-docs/docs/next/tutorials/music-store-app/add-items-to-users-collection"}},s={},u=[{value:"Buy Album Command",id:"buy-album-command",level:2},{value:"Button Data Binding",id:"button-data-binding",level:2},{value:"Close the Dialog",id:"close-the-dialog",level:2}],c={toc:u},d="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(d,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"dialog-return"},"Dialog Return"),(0,o.kt)("p",null,"On the this page you add code to return a selected album from the search dialog to the main window."," "),(0,o.kt)("h2",{id:"buy-album-command"},"Buy Album Command"),(0,o.kt)("p",null,"The first step here is for you to add a reactive command to the music store view model. You will bind this to the ",(0,o.kt)("strong",{parentName:"p"},"Buy Album")," button on the music store view.  "," "),(0,o.kt)("p",null,"Follow this procedure to add the reactive command:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Stop the app if it is running."),(0,o.kt)("li",{parentName:"ul"},"Locate and open the ",(0,o.kt)("strong",{parentName:"li"},"MusicStoreViewModel.cs")," file."),(0,o.kt)("li",{parentName:"ul"},"Add the reactive command declaration, as shown:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"public ReactiveCommand<Unit, AlbumViewModel?> BuyMusicCommand { get; }\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Add code to the constructor to initialize the reactive command, as shown:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"public MusicStoreViewModel()\n{\n    BuyMusicCommand = ReactiveCommand.Create(() =>\n    {\n         return SelectedAlbum;\n    });\n    \n    ...\n}\n")),(0,o.kt)("p",null,"Notice you are using ",(0,o.kt)("inlineCode",{parentName:"p"},"ReactiveCommand")," here. This is provided by the ",(0,o.kt)("em",{parentName:"p"},"ReactiveUI")," framework to implement some of the MVVM interactions. Specifically, it will allow us to pass an argument of class ",(0,o.kt)("inlineCode",{parentName:"p"},"AlbumViewModel")," back to the main window view model, when the button is clicked."),(0,o.kt)("h2",{id:"button-data-binding"},"Button Data Binding"),(0,o.kt)("p",null,"Your next step is bind the ",(0,o.kt)("strong",{parentName:"p"},"Buy Album")," button to the reactive command in the music store view model, follow this procedure:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Locate and open the ",(0,o.kt)("strong",{parentName:"li"},"MusicStoreView .cs")," file. "," "),(0,o.kt)("li",{parentName:"ul"},"Add the data binding ",(0,o.kt)("inlineCode",{parentName:"li"},'Command="{Binding BuyMusicCommand}"')," to the button element.")),(0,o.kt)("h2",{id:"close-the-dialog"},"Close the Dialog"),(0,o.kt)("p",null,"In this step, you will add some window management so that the dialog closes when the user clicks the ",(0,o.kt)("strong",{parentName:"p"},"Buy Album")," button. This is needed in addition to the data binding you just added."),(0,o.kt)("p",null,"As you saw during coding for the dialog open, you implement window management in the code-behind for a window, and use features of the ",(0,o.kt)("inlineCode",{parentName:"p"},"ReactiveWindow")," from the ",(0,o.kt)("em",{parentName:"p"},"ReactiveUI")," framework."),(0,o.kt)("p",null,"To add code to close the dialog, follow this procedure:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Locate and open the ",(0,o.kt)("strong",{parentName:"li"},"MusicStoreWindow.axaml.cs")," file."," "),(0,o.kt)("li",{parentName:"ul"},"Add a reference to the system ",(0,o.kt)("inlineCode",{parentName:"li"},"using System;")," "),(0,o.kt)("li",{parentName:"ul"},"Change the base class so the view inherits from ",(0,o.kt)("inlineCode",{parentName:"li"},"ReactiveWindow<MusicStoreViewModel>"),"."),(0,o.kt)("li",{parentName:"ul"},"Then add the following line to the end of the constructor:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"this.WhenActivated(action => action(ViewModel!.BuyMusicCommand.Subscribe(Close)));\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("em",{parentName:"p"},"ReactiveUI")," ",(0,o.kt)("inlineCode",{parentName:"p"},"WhenActivated")," method defines what happens when the window is activated (becomes visible on the screen). The lambda expression will be called, and it is passed an action that is disposable, so that it can be unsubscribed when the window is no longer active."),(0,o.kt)("p",null,"Your music store window code-behind should now look like this."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-csharp"},"using Avalonia.ReactiveUI;\nusing AvaloniaApplication11.ViewModels;\nusing ReactiveUI;\nusing System;\n\nnamespace Avalonia.MusicStore.Views\n{\n    public partial class MusicStoreWindow : ReactiveWindow<MusicStoreViewModel>\n    {\n        public MusicStoreWindow()\n        {\n            InitializeComponent();\n            this.WhenActivated(d => d(ViewModel!.BuyMusicCommand.Subscribe(Close)));\n        }\n    }\n}\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Debug")," to compile and run the project."),(0,o.kt)("li",{parentName:"ul"},"Click the icon button."),(0,o.kt)("li",{parentName:"ul"},"Type some search text."),(0,o.kt)("li",{parentName:"ul"},"Click an album to select it."),(0,o.kt)("li",{parentName:"ul"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Buy Album"),".")),(0,o.kt)("p",null,"You will see the dialog close, but nothing happens in the main window! On the next page you will learn how to add the selected album to a collection in the main window."," "))}p.isMDXComponent=!0}}]);