"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[54503],{33901:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=t(85893),r=t(11151);const o={id:"how-to-create-a-custom-data-binding-converter",title:"How to Create a Custom Data Binding Converter"},i="How to Create a Custom Data Binding Converter",s={id:"guides/data-binding/how-to-create-a-custom-data-binding-converter",title:"How to Create a Custom Data Binding Converter",description:"When one of the built-in data binding converters does not meet your conversion requirements, you can write a custom converter based on the IValueConverter interface. This guide will show you how.",source:"@site/docs/guides/data-binding/how-to-create-a-custom-data-binding-converter.md",sourceDirName:"guides/data-binding",slug:"/guides/data-binding/how-to-create-a-custom-data-binding-converter",permalink:"/avalonia-docs/docs/guides/data-binding/how-to-create-a-custom-data-binding-converter",draft:!1,unlisted:!1,editUrl:"https://github.com/AvaloniaUI/avalonia-docs/tree/main/docs/guides/data-binding/how-to-create-a-custom-data-binding-converter.md",tags:[],version:"current",frontMatter:{id:"how-to-create-a-custom-data-binding-converter",title:"How to Create a Custom Data Binding Converter"},sidebar:"documentationSidebar",previous:{title:"How To Bind from Code",permalink:"/avalonia-docs/docs/guides/data-binding/binding-from-code"},next:{title:"How To Bind Tabs",permalink:"/avalonia-docs/docs/guides/data-binding/how-to-bind-tabs"}},c={},d=[{value:"Example",id:"example",level:2},{value:"Target Property Type",id:"target-property-type",level:2},{value:"More Information",id:"more-information",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"how-to-create-a-custom-data-binding-converter",children:"How to Create a Custom Data Binding Converter"}),"\n",(0,a.jsxs)(n.p,{children:["When one of the built-in data binding converters does not meet your conversion requirements, you can write a custom converter based on the ",(0,a.jsx)(n.code,{children:"IValueConverter"})," interface. This guide will show you how."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["To review the ",(0,a.jsx)(n.em,{children:"Microsoft"})," documentation for the ",(0,a.jsx)(n.code,{children:"IValueConverter"})," interface, see ",(0,a.jsx)(n.a,{href:"https://docs.microsoft.com/en-gb/dotnet/api/system.windows.data.ivalueconverter?view=netframework-4.7.1",children:"here"}),"."]})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["As the ",(0,a.jsx)(n.code,{children:"IValueConverter"})," interface was not available in .NET standard 2.0, Avalonia UI  contains a copy in the ",(0,a.jsx)(n.code,{children:"Avalonia.Data.Converters"})," namespace. You can see the API documentation about this interface, ",(0,a.jsx)(n.a,{href:"https://reference.avaloniaui.net/api/Avalonia.Data.Converters/IValueConverter/",children:"here"}),"."]})}),"\n",(0,a.jsxs)(n.p,{children:["You must reference a custom converter in some resources before it can be used. This can be at any level in your application. In this example, the custom converter ",(0,a.jsx)(n.code,{children:"myConverter"})," is referenced in the window resources:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-markup",children:'<Window xmlns="https://github.com/avaloniaui"\n        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"\n        xmlns:local="clr-namespace:ExampleApp;assembly=ExampleApp">\n\n  <Window.Resources>\n    <local:MyConverter x:Key="myConverter"/>\n  </Window.Resources>\n\n  <TextBlock Text="{Binding Value, Converter={StaticResource myConverter}}"/>\n</Window>\n'})}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"This example data binding converter can convert text to specific case from a parameter:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-markup",children:'<TextBlock Text="{Binding TheContent, \n    Converter={StaticResource textCaseConverter},\n    ConverterParameter=lower}" />\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The above XAML assumes that the ",(0,a.jsx)(n.code,{children:"textCaseConverter"})," has been referenced in a resource."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public class TextCaseConverter : IValueConverter\n{\n    public static readonly TextCaseConverter Instance = new();\n\n    public object? Convert(object? value, Type targetType, object? parameter, \n                                                            CultureInfo culture)\n    {\n        if (value is string sourceText && parameter is string targetCase\n            && targetType.IsAssignableTo(typeof(string)))\n        {\n            switch (targetCase)\n            {\n                case "upper":\n                case "SQL":\n                    return sourceText.ToUpper();\n                case "lower":\n                    return sourceText.ToLower();\n                case "title": // Every First Letter Uppercase\n                    var txtinfo = new System.Globalization.CultureInfo("en-US",false)\n                                    .TextInfo;\n                    return txtinfo.ToTitleCase(sourceText);\n                default:\n                    // invalid option, return the exception below\n                    break;\n            }\n        }\n        // converter used for the wrong type\n        return new BindingNotification(new InvalidCastException(), \n                                                BindingErrorType.Error);\n    }\n\n    public object ConvertBack(object? value, Type targetType, \n                                object? parameter, CultureInfo culture)\n    {\n      throw new NotSupportedException();\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"target-property-type",children:"Target Property Type"}),"\n",(0,a.jsxs)(n.p,{children:["You may want to write a a custom converter that can switch the output type depending on what the target property requires. You can achieve this becuase the ",(0,a.jsx)(n.code,{children:"Convert"})," method receives a ",(0,a.jsx)(n.code,{children:"targetType"})," argument that you can test with the ",(0,a.jsx)(n.code,{children:"IsAssignableTo"})," function."]}),"\n",(0,a.jsxs)(n.p,{children:["In this example, the ",(0,a.jsx)(n.code,{children:"animalConverter"})," can find an image, or a text name for a bound ",(0,a.jsx)(n.code,{children:"Animal"})," class object:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",metastring:"title='XAML'",children:'<Image Width="42" \n       Source="{Binding Animal, Converter={StaticResource animalConverter}}"/>\n<TextBlock \n       Text="{Binding Animal, Converter={StaticResource animalConverter}}" />\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",metastring:"title='AnimalConverter.cs'",children:'public class AnimalConverter : IValueConverter\n{\n    public static readonly AnimalConverter Instance = new();\n\n    public object? Convert( object? value, Type targetType, \n                                    object? parameter, CultureInfo culture )\n    {\n        if (value is Animal animal)\n        {\n            if (targetType.IsAssignableTo(typeof(IImage)))\n            {\n                img = @"icons/generic-animal-placeholder.png"\n                switch (animal)\n                {\n                    case Dog d:\n                      img = d.IsGoodBoy ? @"icons/dog-happy.png" \n                                                      : @"icons/dog.png";\n                      break;\n                    case Cat:\n                      img = @"icons/cat.png";\n                      break;\n                    // etc. etc.\n                }\n                // see https://docs.avaloniaui.net/docs/guides/data-binding/how-to-create-a-custom-data-binding-converter\n                return BitmapAssetValueConverter.Instance\n                    .Convert(img, typeof(Bitmap), parameter, culture);\n            }\n            else if (targetType.IsAssignableTo(typeof(string)))\n            {\n                return !string.IsNullOrEmpty(animal.NickName) ? \n                    $"{animal.Name} \\"{animal.NickName}\\"" : animal.Name;\n            }\n        }\n        // converter used for the wrong type\n        return new BindingNotification(new InvalidCastException(), \n                                                    BindingErrorType.Error);\n        \n    }\n\n    public object ConvertBack( object? value, Type targetType, \n                                    object? parameter, CultureInfo culture )\n    {\n      throw new NotSupportedException();\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"more-information",children:"More Information"}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["For further guidance about how to bind images, see ",(0,a.jsx)(n.a,{href:"/avalonia-docs/docs/guides/data-binding/how-to-bind-image-files",children:"here"}),"."]})})]})}function u(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>s,a:()=>i});var a=t(67294);const r={},o=a.createContext(r);function i(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);