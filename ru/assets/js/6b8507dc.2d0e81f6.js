"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[36925],{95250:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>d});var i=t(85893),s=t(11151),o=t(33968);const l={description:"TUTORIALS - Music Store App"},a="Mock Search",r={id:"tutorials/music-store-app/mock-search",title:"Mock Search",description:"TUTORIALS - Music Store App",source:"@site/i18n/ru/docusaurus-plugin-content-docs/current/tutorials/music-store-app/mock-search.md",sourceDirName:"tutorials/music-store-app",slug:"/tutorials/music-store-app/mock-search",permalink:"/avalonia-docs/ru/docs/tutorials/music-store-app/mock-search",draft:!1,unlisted:!1,editUrl:"https://github.com/AvaloniaUI/avalonia-docs/tree/main/i18n/ru/docusaurus-plugin-content-docs/current/tutorials/music-store-app/mock-search.md",tags:[],version:"current",frontMatter:{description:"TUTORIALS - Music Store App"},sidebar:"documentationSidebar",previous:{title:"Add Dialog Content",permalink:"/avalonia-docs/ru/docs/tutorials/music-store-app/add-content-to-dialog"},next:{title:"Album View",permalink:"/avalonia-docs/ru/docs/tutorials/music-store-app/album-view"}},c={},d=[{value:"Reactive View Model",id:"reactive-view-model",level:2},{value:"Data Binding",id:"data-binding",level:2},{value:"Album Search and Selection",id:"album-search-and-selection",level:2},{value:"Mock Data",id:"mock-data",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"mock-search",children:"Mock Search"}),"\n",(0,i.jsx)(n.p,{children:"On this page you will create the view model for the album search feature, and then bind it to the controls on the new user control. At this stage you will use a mock of the search itself, so that you can concentrate on the view model."}),"\n",(0,i.jsx)(n.h2,{id:"reactive-view-model",children:"Reactive View Model"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.em,{children:"ReactiveUI"})," framework provides ",(0,i.jsx)(n.em,{children:"Avalonia UI"})," with support for its data binding system. You add this support by deriving your view model from the ",(0,i.jsx)(n.code,{children:"ReactiveObject"})," class, via the ",(0,i.jsx)(n.code,{children:"ViewModelBase"})," class that was added to your project at the start, by the solution template."]}),"\n",(0,i.jsxs)(n.p,{children:["Follow this procedure to derive from the ",(0,i.jsx)(n.code,{children:"ReactiveObject"})," class:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Locate and open the ",(0,i.jsx)(n.strong,{children:"MusicStoreViewModel.cs"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["Add the code to derive the class from ",(0,i.jsx)(n.code,{children:"ViewModelBase"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"namespace Avalonia.MusicStore.ViewModels\n{\n    public class MusicStoreViewModel : ViewModelBase\n    {\n    }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This adds the important extension method ",(0,i.jsx)(n.code,{children:"RaiseAndSetIfChanged"})," to your view model, and will allow you to give the properties there the ability to notify changes to the view."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["To review the concepts behind the MVVM pattern and notification, see ",(0,i.jsx)(n.a,{href:"../../concepts/the-mvvm-pattern/",children:"here"}),"."]})}),"\n",(0,i.jsx)(n.p,{children:"At this stage, you will create two properties for the search application logic:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A text string that is the search criteria,"}),"\n",(0,i.jsx)(n.li,{children:"A Boolean that indicates whether the search is busy."}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add the following code to implement the above properties:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"using ReactiveUI;\n\nnamespace AvaloniaApplication11.ViewModels\n{\n    public class MusicStoreViewModel : ViewModelBase\n    {\n        private string? _searchText;\n        private bool _isBusy;\n\n        public string? SearchText\n        {\n            get => _searchText;\n            set => this.RaiseAndSetIfChanged(ref _searchText, value);\n        }\n\n        public bool IsBusy\n        {\n            get => _isBusy;\n            set => this.RaiseAndSetIfChanged(ref _isBusy, value);\n        }\n\n    }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You can see that the properties have a normal public getter which returns the private value field; but the setter calls the ",(0,i.jsx)(n.code,{children:"RaiseAndSetIfChanged"})," method - in order to implement the notification."]}),"\n",(0,i.jsx)(n.h2,{id:"data-binding",children:"Data Binding"}),"\n",(0,i.jsx)(n.p,{children:"Next you will add a data binding to link the view to the view model. The text box will be bound to the search text, and whether the progress bar is visible to the user will  be bound to the Boolean."}),"\n",(0,i.jsx)(n.p,{children:"Follow this procedure to add data binding to the view:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Locate and open the ",(0,i.jsx)(n.strong,{children:"MusicStoreView.axaml"})," file."]}),"\n",(0,i.jsx)(n.li,{children:"Add the binding expressions shown:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<UserControl ...>\n    \x3c!-- ... --\x3e\n    <DockPanel>\n      <StackPanel DockPanel.Dock="Top">\n        <TextBox Text="{Binding SearchText}" Watermark="Search for Albums...." />\n        <ProgressBar IsIndeterminate="True" IsVisible="{Binding IsBusy}" />\n      </StackPanel>\n      <Button Content="Buy Album"\n              DockPanel.Dock="Bottom"\n              HorizontalAlignment="Center" />\n      <ListBox/>\n    </DockPanel>\n    \x3c!-- ... --\x3e\n</UserControl>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"album-search-and-selection",children:"Album Search and Selection"}),"\n",(0,i.jsx)(n.p,{children:"Your next step is to create the music store view model properties needed to process albums. These are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"a collection of album view models to represent the albums that the search might find,"}),"\n",(0,i.jsx)(n.li,{children:"and a property to hold an album if the user selects one."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Here you will use the ",(0,i.jsx)(n.code,{children:"ObservableCollection"})," - this is a collection is capable of notification, and it is provided by the .NET framework."]}),"\n",(0,i.jsx)(n.p,{children:"Follow this procedure to add the above properties:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Locate and open the ",(0,i.jsx)(n.strong,{children:"MusicStoreViewModel.cs"})," file."]}),"\n",(0,i.jsx)(n.li,{children:"Add the following code to the class:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"private AlbumViewModel? _selectedAlbum;\n\npublic ObservableCollection<AlbumViewModel> SearchResults { get; } = new();\n\npublic AlbumViewModel? SelectedAlbum\n{\n    get => _selectedAlbum;\n    set => this.RaiseAndSetIfChanged(ref _selectedAlbum, value);\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Next to bind these properties to the list box in the view, follow this procedure:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Locate and open the ",(0,i.jsx)(n.strong,{children:"MusicStoreView.axaml"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["Add the binding expressions shown to the ",(0,i.jsx)(n.code,{children:"<ListBox>"})," element:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<ListBox ItemsSource="{Binding SearchResults}" SelectedItem="{Binding SelectedAlbum}" />\n'})}),"\n",(0,i.jsx)(n.h2,{id:"mock-data",children:"Mock Data"}),"\n",(0,i.jsx)(n.p,{children:"Now, to test the app at this stage, you will add some mock data directly to the view model."}),"\n",(0,i.jsx)(n.p,{children:"Follow this procedure:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Locate and open the ",(0,i.jsx)(n.strong,{children:"MusicStoreViewModel.cs"})," file again."]}),"\n",(0,i.jsx)(n.li,{children:"Add a constructor to the class, as shown:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:"public MusicStoreViewModel()\n{\n    SearchResults.Add(new AlbumViewModel());\n    SearchResults.Add(new AlbumViewModel());\n    SearchResults.Add(new AlbumViewModel());\n}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Debug"})," to compile and run the project."]}),"\n"]}),"\n",(0,i.jsx)("p",{children:(0,i.jsx)("img",{className:"image-medium-zoom",src:o.Z,alt:""})}),"\n",(0,i.jsx)(n.p,{children:"This shows that the data binding from the list to the album collection in the view model is working, but the view is not graphical yet. On the next page you will develop the app further by replacing the text with graphical album tiles."})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},33968:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/text-list-b5a304b6403f9d3bc33b8aa2ab555e01.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>l});var i=t(67294);const s={},o=i.createContext(s);function l(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);