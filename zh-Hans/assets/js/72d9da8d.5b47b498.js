"use strict";(self.webpackChunkavalonia_docs=self.webpackChunkavalonia_docs||[]).push([[10699],{3905:(n,e,t)=>{t.d(e,{Zo:()=>u,kt:()=>f});var a=t(67294);function r(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,a)}return t}function i(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){r(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function s(n,e){if(null==n)return{};var t,a,r=function(n,e){if(null==n)return{};var t,a,r={},o=Object.keys(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(a=0;a<o.length;a++)t=o[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}var l=a.createContext({}),c=function(n){var e=a.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):i(i({},e),n)),t},u=function(n){var e=c(n.components);return a.createElement(l.Provider,{value:e},n.children)},p="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return a.createElement(a.Fragment,{},e)}},d=a.forwardRef((function(n,e){var t=n.components,r=n.mdxType,o=n.originalType,l=n.parentName,u=s(n,["components","mdxType","originalType","parentName"]),p=c(t),d=r,f=p["".concat(l,".").concat(d)]||p[d]||m[d]||o;return t?a.createElement(f,i(i({ref:e},u),{},{components:t})):a.createElement(f,i({ref:e},u))}));function f(n,e){var t=arguments,r=e&&e.mdxType;if("string"==typeof n||r){var o=t.length,i=new Array(o);i[0]=d;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=n,s[p]="string"==typeof n?n:r,i[1]=s;for(var c=2;c<o;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6589:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=t(87462),r=(t(67294),t(3905));const o={id:"how-to-create-a-custom-page-transition",title:"\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c"},i="\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c",s={unversionedId:"guides/graphics-and-animation/how-to-create-a-custom-page-transition",id:"guides/graphics-and-animation/how-to-create-a-custom-page-transition",title:"\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c",description:"\u672c\u6307\u5357\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u901a\u8fc7\u5b9e\u73b0 IPageTransition \u63a5\u53e3\u6765\u521b\u5efa\u81ea\u5df1\u7684\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c\u3002",source:"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/guides/graphics-and-animation/how-to-create-a-custom-page-transition.md",sourceDirName:"guides/graphics-and-animation",slug:"/guides/graphics-and-animation/how-to-create-a-custom-page-transition",permalink:"/avalonia-docs/zh-Hans/docs/next/guides/graphics-and-animation/how-to-create-a-custom-page-transition",draft:!1,editUrl:"https://github.com/AvaloniaUI/avalonia-docs/tree/main/docs/guides/graphics-and-animation/how-to-create-a-custom-page-transition.md",tags:[],version:"current",frontMatter:{id:"how-to-create-a-custom-page-transition",title:"\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c"},sidebar:"documentationSidebar",previous:{title:"\u5982\u4f55\u6dfb\u52a0\u83dc\u5355\u56fe\u6807",permalink:"/avalonia-docs/zh-Hans/docs/next/guides/graphics-and-animation/how-to-add-menu-icons"},next:{title:"\u5982\u4f55\u4f7f\u7528\u56fe\u6807",permalink:"/avalonia-docs/zh-Hans/docs/next/guides/graphics-and-animation/how-to-use-icons"}},l={},c=[{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u66f4\u591a\u4fe1\u606f",id:"\u66f4\u591a\u4fe1\u606f",level:2}],u={toc:c},p="wrapper";function m(n){let{components:e,...t}=n;return(0,r.kt)(p,(0,a.Z)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c"},"\u5982\u4f55\u521b\u5efa\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c"),(0,r.kt)("p",null,"\u672c\u6307\u5357\u5c06\u5411\u60a8\u5c55\u793a\u5982\u4f55\u901a\u8fc7\u5b9e\u73b0 ",(0,r.kt)("inlineCode",{parentName:"p"},"IPageTransition")," \u63a5\u53e3\u6765\u521b\u5efa\u81ea\u5df1\u7684\u81ea\u5b9a\u4e49\u9875\u9762\u8fc7\u6e21\u6548\u679c\u3002"),(0,r.kt)("p",null,"\u8be5\u63a5\u53e3\u6709\u4e00\u4e2a\u9700\u8981\u5b9e\u73b0\u7684\u65b9\u6cd5\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},"public Task Start(Visual? from, Visual? to, bool forward, \n                                CancellationToken cancellationToken)\n{\n    // \u5728\u8fd9\u91cc\u8bbe\u7f6e\u8fc7\u6e21\u6548\u679c\u3002\n}\n")),(0,r.kt)("h2",{id:"\u793a\u4f8b"},"\u793a\u4f8b"),(0,r.kt)("p",null,"\u6b64\u793a\u4f8b\u5c06\u7f29\u5c0f\u65e7\u89c6\u56fe\uff0c\u7136\u540e\u5782\u76f4\u6253\u5f00\u65b0\u89c6\u56fe\u3002"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-csharp"},'public class CustomTransition : IPageTransition\n{\n    /// <summary>\n    /// \u521d\u59cb\u5316 <see cref="CustomTransition"/> \u7c7b\u7684\u65b0\u5b9e\u4f8b\u3002\n    /// </summary>\n    public CustomTransition()\n    {\n    }\n\n    /// <summary>\n    /// \u521d\u59cb\u5316 <see cref="CustomTransition"/> \u7c7b\u7684\u65b0\u5b9e\u4f8b\u3002\n    /// </summary>\n    /// <param name="duration">The duration of the animation.</param>\n    public CustomTransition(TimeSpan duration)\n    {\n        Duration = duration;\n    }\n\n    /// <summary>\n    /// \u83b7\u53d6\u6216\u8bbe\u7f6e\u52a8\u753b\u7684\u6301\u7eed\u65f6\u95f4\u3002\n    /// </summary>\n    public TimeSpan Duration { get; set; }\n\n    public async Task Start(Visual from, Visual to, bool forward, \n                                            CancellationToken cancellationToken)\n    {\n        if (cancellationToken.IsCancellationRequested)\n        {\n            return;\n        }\n\n        var tasks = new List<Task>();\n        var parent = GetVisualParent(from, to);\n        var scaleYProperty = ScaleTransform.ScaleYProperty;\n\n        if (from != null)\n        {\n            var animation = new Animation\n            {\n                FillMode = FillMode.Forward,\n                Children =\n                {\n                    new KeyFrame\n                    {\n                        Setters = { new Setter \n                        { Property = scaleYProperty, Value = 1d } },\n                        Cue = new Cue(0d)\n                    },\n                    new KeyFrame\n                    {\n                        Setters =\n                        {\n                            new Setter\n                            {\n                                Property = scaleYProperty,\n                                Value = 0d\n                            }\n                        },\n                        Cue = new Cue(1d)\n                    }\n                },\n                Duration = Duration\n            };\n            tasks.Add(animation.RunAsync(from, null, cancellationToken));\n        }\n\n        if (to != null)\n        {\n            to.IsVisible = true;\n            var animation = new Animation\n            {\n                FillMode = FillMode.Forward,\n                Children =\n                {\n                    new KeyFrame\n                    {\n                        Setters =\n                        {\n                            new Setter\n                            {\n                                Property = scaleYProperty,\n                                Value = 0d\n                            }\n                        },\n                        Cue = new Cue(0d)\n                    },\n                    new KeyFrame\n                    {\n                        Setters = { new Setter \n                        { \n                            Property = scaleYProperty, Value = 1d \n                        }},\n                        Cue = new Cue(1d)\n                    }\n                },\n                Duration = Duration\n            };\n            tasks.Add(animation.RunAsync(to, null, cancellationToken));\n        }\n\n        await Task.WhenAll(tasks);\n\n        if (from != null && !cancellationToken.IsCancellationRequested)\n        {\n            from.IsVisible = false;\n        }\n    }\n\n    /// <summary>\n    /// \u83b7\u53d6\u4e24\u4e2a\u63a7\u4ef6\u7684\u5171\u540c\u89c6\u89c9\u7236\u7ea7\u3002\n    /// </summary>\n    /// <param name="from">\u6e90\u63a7\u4ef6\u3002</param>\n    /// <param name="to">\u76ee\u6807\u63a7\u4ef6\u3002</param>\n    /// <returns>\u5171\u540c\u7684\u7236\u7ea7\u3002</returns>\n    /// <exception cref="ArgumentException">\n    /// \u4e24\u4e2a\u63a7\u4ef6\u6ca1\u6709\u5171\u540c\u7684\u7236\u7ea7\u3002\n    /// </exception>\n    /// <remarks>\n    /// \u4efb\u4f55\u4e00\u4e2a\u53c2\u6570\u53ef\u80fd\u4e3anull\uff0c\u4f46\u4e0d\u80fd\u90fd\u4e3anull\u3002\n    /// </remarks>\n    private static IVisual GetVisualParent(IVisual? from, IVisual? to)\n    {\n        var p1 = (from ?? to)!.VisualParent;\n        var p2 = (to ?? from)!.VisualParent;\n\n        if (p1 != null && p2 != null && p1 != p2)\n        {\n            throw new ArgumentException(\n                                "Controls for PageSlide must have same parent.");\n        }\n\n        return p1 ?? throw new InvalidOperationException(\n                                                "Cannot determine visual parent.");\n    }\n}\n')),(0,r.kt)("img",{src:"/img/gitbook-import/assets/TransitioningContentControl\\_03.webp",alt:""}),(0,r.kt)("h2",{id:"\u66f4\u591a\u4fe1\u606f"},"\u66f4\u591a\u4fe1\u606f"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u6709\u5173\u6b64\u63a5\u53e3\u7684\u5b8c\u6574 API \u6587\u6863\uff0c\u8bf7\u53c2\u9605 ",(0,r.kt)("a",{parentName:"p",href:"http://reference.avaloniaui.net/api/Avalonia.Animation/IPageTransition/"},"\u6b64\u5904"),".")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"\u5728 ",(0,r.kt)("em",{parentName:"p"},"GitHub")," \u4e0a\u67e5\u770b\u6e90\u4ee3\u7801 ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/AvaloniaUI/Avalonia/blob/master/src/Avalonia.Base/Animation/IPageTransition.cs"},(0,r.kt)("inlineCode",{parentName:"a"},"IPageTransition.cs")))))}m.isMDXComponent=!0}}]);